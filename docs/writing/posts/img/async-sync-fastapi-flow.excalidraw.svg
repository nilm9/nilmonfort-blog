<svg viewBox="0 0 650 520" xmlns="http://www.w3.org/2000/svg">
  <style>
    .title { font: bold 14px 'Open Sans', sans-serif; fill: #333333; }
    .subtitle { font: 12px 'Open Sans', sans-serif; fill: #666666; }
    .label { font: 11px 'Open Sans', sans-serif; fill: #666666; }
    .code { font: 10px 'Courier New', monospace; fill: #333333; }
    .bridge { font: bold 10px 'Open Sans', sans-serif; fill: #039BE5; }
  </style>

  <!-- HTTP Request (Tertiary) -->
  <ellipse cx="220" cy="35" rx="90" ry="25" fill="#80DEEA" stroke="#0097A7" stroke-width="2"/>
  <text x="220" y="40" text-anchor="middle" class="title">HTTP Request arrives</text>

  <!-- Arrow 1 -->
  <line x1="220" y1="60" x2="220" y2="90" stroke="#333333" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- FastAPI Route (Primary - async) -->
  <rect x="110" y="90" width="220" height="70" rx="8" fill="#B2EBF2" stroke="#06b6d4" stroke-width="2"/>
  <text x="220" y="118" text-anchor="middle" class="title">FastAPI Route</text>
  <text x="220" y="138" text-anchor="middle" class="subtitle">(async def)</text>
  <text x="350" y="125" class="label">← async world (event loop)</text>

  <!-- Arrow 2 -->
  <line x1="220" y1="160" x2="220" y2="190" stroke="#333333" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="240" y="180" class="code">await</text>

  <!-- Use Case (Primary - async) -->
  <rect x="110" y="190" width="220" height="70" rx="8" fill="#B2EBF2" stroke="#06b6d4" stroke-width="2"/>
  <text x="220" y="218" text-anchor="middle" class="title">Use Case</text>
  <text x="220" y="238" text-anchor="middle" class="subtitle">(async def)</text>
  <text x="350" y="225" class="label">← async world</text>

  <!-- Dashed line (boundary) -->
  <line x1="60" y1="285" x2="450" y2="285" stroke="#9E9E9E" stroke-width="1" stroke-dasharray="5,5"/>

  <!-- Arrow 3 (bridge - Accent) -->
  <line x1="220" y1="260" x2="220" y2="320" stroke="#039BE5" stroke-width="2" marker-end="url(#arrow-accent)"/>
  <rect x="235" y="270" width="70" height="22" rx="4" fill="#E1F5FE" stroke="#039BE5" stroke-width="1"/>
  <text x="270" y="285" text-anchor="middle" class="bridge">BRIDGE</text>
  <text x="60" y="282" class="code">asyncio.to_thread(...)</text>

  <!-- Repository (Secondary - sync) -->
  <rect x="110" y="320" width="220" height="70" rx="8" fill="#E0F7FA" stroke="#00ACC1" stroke-width="2"/>
  <text x="220" y="348" text-anchor="middle" class="title">Repository</text>
  <text x="220" y="368" text-anchor="middle" class="subtitle">(def)</text>
  <text x="350" y="355" class="label">← sync (runs in thread pool)</text>

  <!-- Arrow 4 -->
  <line x1="220" y1="390" x2="220" y2="420" stroke="#333333" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="240" y="410" class="code">blocking call</text>

  <!-- Redis (Secondary - sync) -->
  <rect x="150" y="420" width="140" height="60" rx="8" fill="#E0F7FA" stroke="#00ACC1" stroke-width="2"/>
  <text x="220" y="455" text-anchor="middle" class="title">Redis</text>
  <text x="350" y="450" class="label">← sync blocking I/O</text>

  <!-- Arrow markers -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#333333"/>
    </marker>
    <marker id="arrow-accent" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#039BE5"/>
    </marker>
  </defs>
</svg>
